var c=document.getElementById("terminal-input"),_=document.getElementById("terminal-input-row"),T=document.getElementById("autocomplete"),g=document.getElementById("terminal-body"),i=document.getElementById("terminal-window"),Z=document.getElementById("terminal-btn-close"),Q=document.getElementById("terminal-trigger");var S=!1,b=!1,$=0,K=0,U=0,F=0,Re=(e)=>{if("touches"in e)return{clientX:e.touches[0]?.pageX,clientY:e.touches[0]?.pageY};else return{clientX:e.pageX,clientY:e.pageY}};i.addEventListener("mousedown",(e)=>{let t=i.getBoundingClientRect(),r=20;if(e.pageX>t.right-20&&e.pageY>t.bottom-20)b=!0});i.onmousedown=(e)=>{if(b)return;ee(e)};i.ontouchstart=(e)=>{if(e.preventDefault(),b)return;ee(e)};function ee(e){let{clientX:t,clientY:r}=Re(e);if(!t||!r)return;S=!0,$=t,K=r,U=parseInt(i.style.left||"0",10),F=parseInt(i.style.top||"0",10),i.style.cursor="grabbing",i.style.userSelect="none",document.body.style.userSelect="none"}document.addEventListener("mousemove",(e)=>{if(b||!S)return;let t=U+(e.pageX-$),r=F+(e.pageY-K);i.style.left=`${t}px`,i.style.top=`${r}px`});document.addEventListener("touchmove",(e)=>{if(b||!S)return;let t=e.touches[0];if(!t)return;let r=U+(t.pageX-$),o=F+(t.pageY-K);i.style.left=`${r}px`,i.style.top=`${o}px`},{passive:!1});document.addEventListener("mouseup",()=>{S=!1,b=!1,i.style.cursor="",i.style.userSelect="",document.body.style.userSelect=""});document.addEventListener("touchend",()=>{S=!1,b=!1,i.style.cursor="",i.style.userSelect="",document.body.style.userSelect=""});var te=()=>{i.classList.remove("open"),i.classList.add("close"),q=!1};Z.onclick=te;var G=()=>{i.classList.remove("hidden"),i.classList.remove("close"),i.classList.add("open"),c.focus(),q=!0},q=!1;Q.onclick=()=>{if(q)te();else G()};var p=(e)=>{let t=Array.isArray(e)?e:[e];for(let r of t){let o=document.createElement("p");o.className="terminal-line",o.textContent=`${r}`,g.appendChild(o)}};var re={name:"help",exec:()=>{return p(["help","ls","cd ( doesnt work yet )","slowking","echo","clear","history"]),0}};var oe={name:"slowking",exec:()=>{return p("Thats Me!"),0}};var N=new Map([["PATH","/aswsome/binaries"],["HOME","/Rakeli/Home"],["WORKING_DIR","/Rakeli/Home"],["EXIT_CODE",0]]);var ne={name:"echo",exec:(e)=>{if(!e||e.length<2)return 1;let t=e.slice(1).join(" "),r=e[1];switch(r){case"$?":{let o=N.get("EXIT_CODE");return p(String(o)),0}default:if(r?.startsWith("$")){let o=r.slice(1),n=N.get(o);if(n!==void 0)return p(String(n)),0;else return p(`No such variable: ${o}`),1}}return p(t),0}};var se={name:"ls",exec:()=>{return p(["Pages on this Website:","About_Me","Writeups","Projects","Home"]),0}};var ae={name:"cd",exec:()=>{return 0}};var O={name:"clear",exec:(e)=>{if(!g||!e)return 0;let t=2,r=t+1+(e[0]==="clear"?1:0);while(g.children.length>r){let o=g.children[t];if(!o)break;g?.removeChild(o)}return 0}};var y=[],v=0,De=100,ie=(e)=>{if(y[y.length-1]===e)return;if(y.length===De)y.shift();y.push(e),v=y.length},me=()=>{if(v--,v<0)v=0;return y[v]},le=()=>{if(v++,v>y.length){v--;return}return y[v]},ce=()=>{return y};var pe={name:"history",exec:()=>{return p(ce()),0}};var X=[oe,ne,se,ae,O,re,pe];var Oe=(e)=>{let t={children:new Map};for(let r of e){let o=t;for(let n of r.name){if(!o.children.has(n))o.children.set(n,{children:new Map});o=o.children.get(n)}o.command=r}return t},ue=(e)=>{if(!e||R===null)return[];let t=R;for(let n of e){let s=t.children.get(n);if(!s)return[];t=s}function r(n){if(n.command?.name.startsWith(e))return n.command.name;if(n.line?.startsWith(e))return n.line;for(let s of n.children.values()){let m=r(s);if(m)return m}return}let o=r(t);return o?[o]:[]},de=(e)=>{if(!e||R===null)return;let t=R;for(let r of e){let o=t.children.get(r);if(!o)return;t=o}return t.command?.name===e?t.command:void 0},fe=(e,t=R)=>{let r=t;for(let o of e){if(!r.children.has(o))r.children.set(o,{children:new Map});r=r.children.get(o)}r.line=e},R=Oe(X);var P=()=>{g.removeChild(_),g.appendChild(_),c.focus()};var ge=(e,t)=>{if(e===t)return 0;let r=e.length,o=t.length;if(r===0||o===0)return r+o;let n=0,s,m,u,l,a,f,L,I,B=new Array(r);for(s=0;s<r;)B[s]=++s;for(;n+3<o;n+=4){let W=t.charCodeAt(n),Be=t.charCodeAt(n+1),Se=t.charCodeAt(n+2),Ne=t.charCodeAt(n+3);l=n,u=n+1,a=n+2,f=n+3,L=n+4;for(s=0;s<r;s++){if(I=e.charCodeAt(s),m=B[s],m<l||u<l)l=m>u?u+1:m+1;else if(W!==I)l++;if(l<u||a<u)u=l>a?a+1:l+1;else if(Be!==I)u++;if(u<a||f<a)a=u>f?f+1:u+1;else if(Se!==I)a++;if(a<f||L<f)f=a>L?L+1:a+1;else if(Ne!==I)f++;B[s]=L=f,f=a,a=u,u=l,l=m}}for(;n<o;){let W=t.charCodeAt(n);l=n,a=++n;for(s=0;s<r;s++){if(m=B[s],m<l||a<l)a=m>a?a+1:m+1;else if(W!==e.charCodeAt(s))a=l+1;else a=l;B[s]=a,l=m}L=a}return L};var ye=(e)=>{let t={};return X.forEach((r)=>{let o=ge(e,r.name);if(!t.name||!t.distance||t.distance>o)t.name=r.name,t.distance=o;return}),t.name};var rr=document.getElementById("winamp"),h=document.getElementById("winamp-audio"),j=document.getElementById("winamp-graph"),he=document.getElementById("winamp-resume"),ve=document.getElementById("winamp-pause"),Ee=document.getElementById("winamp-prev"),xe=document.getElementById("winamp-next"),Y=document.getElementById("winamp-track-name"),E=document.getElementById("winamp-shuffle"),x=document.getElementById("winamp-repeat");var w=["bleach.mp3","terraria.mp3","bg.mp3"];function V(e,t,r){t-=1;let o=Math.ceil(e),n=Math.floor(t),s=n-o+1;if(s<=1&&r>=o&&r<=n)throw new Error("No valid numbers available in the given range excluding the specified value.");let m;do m=Math.floor(Math.random()*s)+o;while(m===r);return m}var Le="assets/storage/mp3/",d={val:0},k={val:!1},C={val:!1},Te=()=>{if(k.val)return A();if(C.val)d.val=V(0,w.length,d.val);else d.val=(d.val+1)%w.length;return A()},be=()=>{if(k.val)return A();if(C.val)d.val=V(0,w.length,d.val);else if(d.val=d.val-1,d.val<0)d.val=w.length-1;return A()},we=()=>{C.val=!C.val,k.val=!1},ke=()=>{k.val=!k.val,C.val=!1},A=()=>{let e=w[d.val];if(!e)return console.error("No track :(",d.val),Le+"error.mp3";return Le+e},z=()=>{let e=w[d.val];if(!e)return console.error("No track :("),"error.mp3";return e};var M=64;for(let e=0;e<M;e++){let t=document.createElement("div");t.classList.add("bar"),t.style.flex="1",t.style.background=`hsl(${e/M*360}, 70%, 50%)`,t.style.height="0%",j.appendChild(t)}var Xe=j.querySelectorAll(".bar"),D=new window.AudioContext,Pe=D.createMediaElementSource(h),H=D.createAnalyser();H.fftSize=2048;H.smoothingTimeConstant=0.7;Pe.connect(H);H.connect(D.destination);var J=H.frequencyBinCount,Ce=new Uint8Array(J),Ae=new Float32Array(M);function Me(){H.getByteFrequencyData(Ce);for(let e=0;e<M;e++){let t=Math.floor(e*J/M),r=Math.max(t+1,Math.floor((e+1)*J/M)),o=0;for(let l=t;l<r;l++)o+=Ce[l];let n=o/(r-t)/255,s=Math.pow(n,1.3)*100,m=Ae[e]*0.6+s*0.4;Ae[e]=m;let u=Xe[e];u.style.height=m+"%"}requestAnimationFrame(Me)}function He(e){h.src=e,h.load(),h.play()}h.addEventListener("play",()=>{if(D.state==="suspended")D.resume();Me()});he.onclick=()=>h.play();ve.onclick=()=>h.pause();function Ie(){if(k.val)x.classList.remove("bg-gray-700","hover:bg-gray-600"),x.classList.add("bg-blue-600","hover:bg-blue-700");else x.classList.remove("bg-blue-600","hover:bg-blue-700"),x.classList.add("bg-gray-700","hover:bg-gray-600");if(C.val)E.classList.remove("bg-gray-500","hover:bg-gray-600"),E.classList.add("bg-green-700","hover:bg-green-900");else E.classList.remove("bg-green-700","hover:bg-green-900"),E.classList.add("bg-gray-500","hover:bg-gray-600")}E.onclick=()=>{we(),E.classList.remove("bg-green-700","bg-gray-500","hover:bg-green-900","hover:bg-gray-600","transition-colors"),E.classList.add("transition-colors"),Ie()};x.onclick=()=>{ke(),x.classList.remove("bg-blue-500","bg-gray-500","hover:bg-blue-600","hover:bg-gray-600","transition-colors"),x.classList.add("transition-colors"),Ie()};Ee.onclick=()=>{He(be()),Y.innerHTML=z()};xe.onclick=()=>{He(Te()),Y.innerHTML=z()};h.src=A();h.load();Y.innerHTML=z();c.addEventListener("keydown",(e)=>{if(e.ctrlKey&&e.key.toLowerCase()==="l"){e.preventDefault(),O.exec(["shortcut"]);return}switch(e.key){case"Enter":{let t=c.value,r=t.split(" ");if(!t||!r||!r[0]){p("No detectable input ;-;"),P(),c.value="";break}let o=de(r[0]);if(p("> "+t),ie(t),fe(t),!o){let n=ye(r[0]);if(!n)p("Command doesn't exist :(");else p(["Command doesn't exist, did you mean:",n]);P(),c.value="";break}N.set("EXIT_CODE",o.exec(r)),P(),c.value="";break}case"ArrowRight":{let t=T.textContent?.trim();if(t&&t.startsWith(c.value))c.value=t,T.innerHTML="";break}case"ArrowUp":{e.preventDefault();let t=me();if(T.innerHTML="",!t)break;c.value=t,c.setSelectionRange(t.length,t.length);break}case"ArrowDown":{let t=le();if(T.innerHTML="",!t){c.value="";break}c.value=t,c.setSelectionRange(t.length,t.length);break}default:{let t=c.value+e.key,r=ue(t);if(r.length===0||!r[0]){T.innerHTML="";break}let o=r[0];T.innerHTML=o;break}}});document.addEventListener("keydown",(e)=>{if(e.ctrlKey&&e.key&&e.key.toLowerCase()==="n")e.preventDefault(),G()});

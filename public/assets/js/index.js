var a=document.getElementById("terminal-input"),T=document.getElementById("terminal-input-row"),h=document.getElementById("autocomplete"),d=document.getElementById("terminal-body"),U=document.getElementById("terminal-line-template");var i=(e)=>{let t=Array.isArray(e)?e:[e];for(let o of t){let r=document.createElement("p");r.className="terminal-line",r.textContent=`${o}`,d.appendChild(r)}};var H={name:"help",exec:()=>{return i(["help","ls","cd ( doesnt work yet )","slowking","echo","clear","history"]),0}};var E=new Map([["PATH","/aswsome/binaries"],["HOME","/Rakeli/Home"],["WORKING_DIR","/Rakeli/Home"],["EXIT_CODE",0]]);var v={name:"echo",exec:(e)=>{if(!e||e.length<2)return 1;let t=e.slice(1).join(" "),o=e[1];switch(o){case"$?":{let r=E.get("EXIT_CODE");return i(String(r)),0}default:if(o?.startsWith("$")){let r=o.slice(1),n=E.get(r);if(n!==void 0)return i(String(n)),0;else return i(`No such variable: ${r}`),1}}return i(t),0}};var I={name:"ls",exec:()=>{return i(["Pages on this Website:","About_Me","Writeups","Projects","Home"]),0}};var M={name:"cd",exec:()=>{return 0}};var S={name:"slowking",exec:()=>{return i("Thats Me!"),0}};var b={name:"clear",exec:(e)=>{if(!d||!e)return 0;let t=2,o=t+1+(e[0]==="clear"?1:0);while(d.children.length>o){let r=d.children[t];if(!r)break;d?.removeChild(r)}return 0}};var u=[],y=0,G=100,N=(e)=>{if(u[u.length-1]===e)return;if(u.length===G)u.shift();u.push(e),y=u.length},D=()=>{if(y--,y<0)y=0;return u[y]},B=()=>{if(y++,y>u.length){y--;return}return u[y]},O=()=>{return u};var R={name:"history",exec:()=>{return i(O()),0}};var w=[H,v,I,M,S,b,R];var z=(e)=>{console.log("Building Commands...");let t={children:new Map};for(let o of e){let r=t;for(let n of o.name){if(!r.children.has(n))r.children.set(n,{children:new Map});r=r.children.get(n)}r.command=o}return t},_=(e)=>{if(!e||k===null)return[];let t=k;for(let n of e){let s=t.children.get(n);if(!s)return[];t=s}function o(n){if(n.command?.name.startsWith(e))return n.command.name;if(n.line?.startsWith(e))return n.line;for(let s of n.children.values()){let l=o(s);if(l)return l}return}let r=o(t);return r?[r]:[]},K=(e)=>{if(!e||k===null)return;let t=k;for(let o of e){let r=t.children.get(o);if(!r)return;t=r}return t.command?.name===e?t.command:void 0},P=(e,t=k)=>{let o=t;for(let r of e){if(!o.children.has(r))o.children.set(r,{children:new Map});o=o.children.get(r)}o.line=e},k=z(w);var A=()=>{d.removeChild(T),d.appendChild(T),a.focus()};var W=(e,t)=>{if(e===t)return 0;let o=e.length,r=t.length;if(o===0||r===0)return o+r;let n=0,s,l,c,p,m,f,g,C,x=new Array(o);for(s=0;s<o;)x[s]=++s;for(;n+3<r;n+=4){let L=t.charCodeAt(n),V=t.charCodeAt(n+1),X=t.charCodeAt(n+2),j=t.charCodeAt(n+3);p=n,c=n+1,m=n+2,f=n+3,g=n+4;for(s=0;s<o;s++){if(C=e.charCodeAt(s),l=x[s],l<p||c<p)p=l>c?c+1:l+1;else if(L!==C)p++;if(p<c||m<c)c=p>m?m+1:p+1;else if(V!==C)c++;if(c<m||f<m)m=c>f?f+1:c+1;else if(X!==C)m++;if(m<f||g<f)f=m>g?g+1:m+1;else if(j!==C)f++;x[s]=g=f,f=m,m=c,c=p,p=l}}for(;n<r;){let L=t.charCodeAt(n);p=n,m=++n;for(s=0;s<o;s++){if(l=x[s],l<p||m<p)m=l>m?m+1:l+1;else if(L!==e.charCodeAt(s))m=p+1;else m=p;x[s]=m,p=l}g=m}return g};var $=(e)=>{let t={};return w.forEach((o)=>{let r=W(e,o.name);if(!t.name||!t.distance||t.distance>r)t.name=o.name,t.distance=r;return}),t.name};a.addEventListener("keydown",(e)=>{if(e.ctrlKey&&e.key.toLowerCase()==="l"){e.preventDefault(),b.exec(["shortcut"]);return}switch(e.key){case"Enter":{let t=a.value,o=t.split(" ");if(!t||!o||!o[0]){i("No detectable input ;-;"),A(),a.value="";break}let r=K(o[0]);if(i("> "+t),N(t),P(t),!r){let n=$(o[0]);if(!n)i("Command doesn't exist :(");else i(["Command doesn't exist, did you mean:",n]);A(),a.value="";break}E.set("EXIT_CODE",r.exec(o)),A(),a.value="";break}case"ArrowRight":{let t=h.textContent?.trim();if(t&&t.startsWith(a.value))a.value=t,h.innerHTML="";break}case"ArrowUp":{e.preventDefault();let t=D();if(h.innerHTML="",!t)break;a.value=t,a.setSelectionRange(t.length,t.length);break}case"ArrowDown":{let t=B();if(h.innerHTML="",!t){a.value="";break}a.value=t,a.setSelectionRange(t.length,t.length);break}default:{let t=a.value+e.key,o=_(t);if(o.length===0||!o[0]){h.innerHTML="";break}let r=o[0];h.innerHTML=r;break}}});

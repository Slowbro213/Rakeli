var c=document.getElementById("terminal-input"),_=document.getElementById("terminal-input-row"),L=document.getElementById("autocomplete"),g=document.getElementById("terminal-body"),i=document.getElementById("terminal-window"),Z=document.getElementById("terminal-btn-close"),Q=document.getElementById("terminal-trigger");var S=!1,b=!1,$=0,K=0,U=0,G=0,Re=(e)=>{if("touches"in e)return{clientX:e.touches[0]?.pageX,clientY:e.touches[0]?.pageY};else return{clientX:e.pageX,clientY:e.pageY}};i.addEventListener("mousedown",(e)=>{let t=i.getBoundingClientRect(),o=20;if(e.pageX>t.right-20&&e.pageY>t.bottom-20)b=!0});i.onmousedown=(e)=>{if(b)return;ee(e)};i.ontouchstart=(e)=>{if(e.preventDefault(),b)return;ee(e)};function ee(e){let{clientX:t,clientY:o}=Re(e);if(!t||!o)return;S=!0,$=t,K=o,U=parseInt(i.style.left||"0",10),G=parseInt(i.style.top||"0",10),i.style.cursor="grabbing",i.style.userSelect="none",document.body.style.userSelect="none"}document.addEventListener("mousemove",(e)=>{if(b||!S)return;let t=U+(e.pageX-$),o=G+(e.pageY-K);i.style.left=`${t}px`,i.style.top=`${o}px`});document.addEventListener("touchmove",(e)=>{if(b||!S)return;let t=e.touches[0];if(!t)return;let o=U+(t.pageX-$),r=G+(t.pageY-K);i.style.left=`${o}px`,i.style.top=`${r}px`},{passive:!1});document.addEventListener("mouseup",()=>{S=!1,b=!1,i.style.cursor="",i.style.userSelect="",document.body.style.userSelect=""});document.addEventListener("touchend",()=>{S=!1,b=!1,i.style.cursor="",i.style.userSelect="",document.body.style.userSelect=""});var te=()=>{i.classList.remove("open"),i.classList.add("close"),F=!1};Z.onclick=te;var q=()=>{i.classList.remove("hidden"),i.classList.remove("close"),i.classList.add("open"),c.focus(),F=!0},F=!1;Q.onclick=()=>{if(F)te();else q()};var p=(e)=>{let t=Array.isArray(e)?e:[e];for(let o of t){let r=document.createElement("p");r.className="terminal-line",r.textContent=`${o}`,g.appendChild(r)}};var oe={name:"help",exec:()=>{return p(["help","ls","cd ( doesnt work yet )","slowking","echo","clear","history"]),0}};var N=new Map([["PATH","/aswsome/binaries"],["HOME","/Rakeli/Home"],["WORKING_DIR","/Rakeli/Home"],["EXIT_CODE",0]]);var re={name:"echo",exec:(e)=>{if(!e||e.length<2)return 1;let t=e.slice(1).join(" "),o=e[1];switch(o){case"$?":{let r=N.get("EXIT_CODE");return p(String(r)),0}default:if(o?.startsWith("$")){let r=o.slice(1),n=N.get(r);if(n!==void 0)return p(String(n)),0;else return p(`No such variable: ${r}`),1}}return p(t),0}};var ne={name:"ls",exec:()=>{return p(["Pages on this Website:","About_Me","Writeups","Projects","Home"]),0}};var se={name:"cd",exec:()=>{return 0}};var ae={name:"slowking",exec:()=>{return p("Thats Me!"),0}};var O={name:"clear",exec:(e)=>{if(!g||!e)return 0;let t=2,o=t+1+(e[0]==="clear"?1:0);while(g.children.length>o){let r=g.children[t];if(!r)break;g?.removeChild(r)}return 0}};var y=[],v=0,De=100,ie=(e)=>{if(y[y.length-1]===e)return;if(y.length===De)y.shift();y.push(e),v=y.length},me=()=>{if(v--,v<0)v=0;return y[v]},le=()=>{if(v++,v>y.length){v--;return}return y[v]},ce=()=>{return y};var pe={name:"history",exec:()=>{return p(ce()),0}};var X=[oe,re,ne,se,ae,O,pe];var Oe=(e)=>{let t={children:new Map};for(let o of e){let r=t;for(let n of o.name){if(!r.children.has(n))r.children.set(n,{children:new Map});r=r.children.get(n)}r.command=o}return t},ue=(e)=>{if(!e||R===null)return[];let t=R;for(let n of e){let s=t.children.get(n);if(!s)return[];t=s}function o(n){if(n.command?.name.startsWith(e))return n.command.name;if(n.line?.startsWith(e))return n.line;for(let s of n.children.values()){let m=o(s);if(m)return m}return}let r=o(t);return r?[r]:[]},de=(e)=>{if(!e||R===null)return;let t=R;for(let o of e){let r=t.children.get(o);if(!r)return;t=r}return t.command?.name===e?t.command:void 0},fe=(e,t=R)=>{let o=t;for(let r of e){if(!o.children.has(r))o.children.set(r,{children:new Map});o=o.children.get(r)}o.line=e},R=Oe(X);var P=()=>{g.removeChild(_),g.appendChild(_),c.focus()};var ge=(e,t)=>{if(e===t)return 0;let o=e.length,r=t.length;if(o===0||r===0)return o+r;let n=0,s,m,u,l,a,f,w,I,B=new Array(o);for(s=0;s<o;)B[s]=++s;for(;n+3<r;n+=4){let W=t.charCodeAt(n),Be=t.charCodeAt(n+1),Se=t.charCodeAt(n+2),Ne=t.charCodeAt(n+3);l=n,u=n+1,a=n+2,f=n+3,w=n+4;for(s=0;s<o;s++){if(I=e.charCodeAt(s),m=B[s],m<l||u<l)l=m>u?u+1:m+1;else if(W!==I)l++;if(l<u||a<u)u=l>a?a+1:l+1;else if(Be!==I)u++;if(u<a||f<a)a=u>f?f+1:u+1;else if(Se!==I)a++;if(a<f||w<f)f=a>w?w+1:a+1;else if(Ne!==I)f++;B[s]=w=f,f=a,a=u,u=l,l=m}}for(;n<r;){let W=t.charCodeAt(n);l=n,a=++n;for(s=0;s<o;s++){if(m=B[s],m<l||a<l)a=m>a?a+1:m+1;else if(W!==e.charCodeAt(s))a=l+1;else a=l;B[s]=a,l=m}w=a}return w};var ye=(e)=>{let t={};return X.forEach((o)=>{let r=ge(e,o.name);if(!t.name||!t.distance||t.distance>r)t.name=o.name,t.distance=r;return}),t.name};var oo=document.getElementById("winamp"),h=document.getElementById("winamp-audio"),j=document.getElementById("winamp-graph"),he=document.getElementById("winamp-resume"),ve=document.getElementById("winamp-pause"),Ee=document.getElementById("winamp-prev"),xe=document.getElementById("winamp-next"),Y=document.getElementById("winamp-track-name"),E=document.getElementById("winamp-shuffle"),x=document.getElementById("winamp-repeat");var T=["bg.mp3","bleach.mp3","terraria.mp3"];function V(e,t,o){t-=1;let r=Math.ceil(e),n=Math.floor(t),s=n-r+1;if(s<=1&&o>=r&&o<=n)throw new Error("No valid numbers available in the given range excluding the specified value.");let m;do m=Math.floor(Math.random()*s)+r;while(m===o);return m}var we="assets/storage/mp3/",d={val:0},k={val:!1},C={val:!1},Le=()=>{if(k.val)return A();if(C.val)d.val=V(0,T.length,d.val);else d.val=(d.val+1)%T.length;return A()},be=()=>{if(k.val)return A();if(C.val)d.val=V(0,T.length,d.val);else if(d.val=d.val-1,d.val<0)d.val=T.length-1;return A()},Te=()=>{C.val=!C.val,k.val=!1},ke=()=>{k.val=!k.val,C.val=!1},A=()=>{let e=T[d.val];if(!e)return console.error("No track :(",d.val),we+"error.mp3";return we+e},z=()=>{let e=T[d.val];if(!e)return console.error("No track :("),"error.mp3";return e};var M=64;for(let e=0;e<M;e++){let t=document.createElement("div");t.classList.add("bar"),t.style.flex="1",t.style.background=`hsl(${e/M*360}, 70%, 50%)`,t.style.height="0%",j.appendChild(t)}var Xe=j.querySelectorAll(".bar"),D=new(window.AudioContext||window.webkitAudioContext),Pe=D.createMediaElementSource(h),H=D.createAnalyser();H.fftSize=2048;H.smoothingTimeConstant=0.7;Pe.connect(H);H.connect(D.destination);var J=H.frequencyBinCount,Ce=new Uint8Array(J),Ae=new Float32Array(M);function Me(){H.getByteFrequencyData(Ce);for(let e=0;e<M;e++){let t=Math.floor(e*J/M),o=Math.max(t+1,Math.floor((e+1)*J/M)),r=0;for(let l=t;l<o;l++)r+=Ce[l];let n=r/(o-t)/255,s=Math.pow(n,1.3)*100,m=Ae[e]*0.6+s*0.4;Ae[e]=m;let u=Xe[e];u.style.height=m+"%"}requestAnimationFrame(Me)}function He(e){h.src=e,h.load(),h.play()}h.addEventListener("play",()=>{if(D.state==="suspended")D.resume();Me()});he.onclick=()=>h.play();ve.onclick=()=>h.pause();function Ie(){if(k.val)x.classList.remove("bg-gray-700","hover:bg-gray-600"),x.classList.add("bg-blue-600","hover:bg-blue-700");else x.classList.remove("bg-blue-600","hover:bg-blue-700"),x.classList.add("bg-gray-700","hover:bg-gray-600");if(C.val)E.classList.remove("bg-gray-500","hover:bg-gray-600"),E.classList.add("bg-green-700","hover:bg-green-900");else E.classList.remove("bg-green-700","hover:bg-green-900"),E.classList.add("bg-gray-500","hover:bg-gray-600")}E.onclick=()=>{Te(),E.classList.remove("bg-green-700","bg-gray-500","hover:bg-green-900","hover:bg-gray-600","transition-colors"),E.classList.add("transition-colors"),Ie()};x.onclick=()=>{ke(),x.classList.remove("bg-blue-500","bg-gray-500","hover:bg-blue-600","hover:bg-gray-600","transition-colors"),x.classList.add("transition-colors"),Ie()};Ee.onclick=()=>{He(be()),Y.innerHTML=z()};xe.onclick=()=>{He(Le()),Y.innerHTML=z()};h.src=A();h.load();Y.innerHTML=z();c.addEventListener("keydown",(e)=>{if(e.ctrlKey&&e.key.toLowerCase()==="l"){e.preventDefault(),O.exec(["shortcut"]);return}switch(e.key){case"Enter":{let t=c.value,o=t.split(" ");if(!t||!o||!o[0]){p("No detectable input ;-;"),P(),c.value="";break}let r=de(o[0]);if(p("> "+t),ie(t),fe(t),!r){let n=ye(o[0]);if(!n)p("Command doesn't exist :(");else p(["Command doesn't exist, did you mean:",n]);P(),c.value="";break}N.set("EXIT_CODE",r.exec(o)),P(),c.value="";break}case"ArrowRight":{let t=L.textContent?.trim();if(t&&t.startsWith(c.value))c.value=t,L.innerHTML="";break}case"ArrowUp":{e.preventDefault();let t=me();if(L.innerHTML="",!t)break;c.value=t,c.setSelectionRange(t.length,t.length);break}case"ArrowDown":{let t=le();if(L.innerHTML="",!t){c.value="";break}c.value=t,c.setSelectionRange(t.length,t.length);break}default:{let t=c.value+e.key,o=ue(t);if(o.length===0||!o[0]){L.innerHTML="";break}let r=o[0];L.innerHTML=r;break}}});document.addEventListener("keydown",(e)=>{if(e.ctrlKey&&e.key&&e.key.toLowerCase()==="n")e.preventDefault(),q()});
